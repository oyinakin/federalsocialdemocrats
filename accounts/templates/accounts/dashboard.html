{% load static %}
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link rel="stylesheet" href="/static/accounts/css/style2.css">
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!--          -->
    <style>
    .tab-content2{
      display: flex;
    flex: 1 0 auto;
    margin-left: 20%;
    }
    .tab-pane2{
      width: 100%;
    }
    .fa{
    	padding-right: 10%;
    	color:#fff;
    }
    .sidebar nav div ul li.active {
    	background-color: #fff;
    	color: #008753;
    }.sidebar nav ul li.active a {
    	color: #008753;
    	text-decoration: none;
    }
    .sidebar nav ul li.active i {
    	color: #008753;
    	text-decoration: none;
    }
    @media only screen and (max-width: 768px){
      .col30,.col60{width: 30%}
      .tab-content2{
        margin-left: 0;
        width: 100%;
        margin-right: 0;
      }
    }

    .row1, .row2,.row3, .rowfull, .row{
      width: 100%;
      margin: auto;
    }
    .row3{
      margin-top: -10%;
    }
    .row2{
      display: inline-flex;
    }
    .rowfull{
      width: 100%;
    }
    @media only screen and (max-width:580px){
.nav-btn {
		width:100vw;
    background-color: #008753;
    height:10vh;
	}
  .hidelogo{
    display:none !important;
  }
}
.nav-btn div{
		width:18vw;
    background-color: #fff;
    height:80%;
    float: right;
    margin: 2%;
    border-radius: 5px;

	}

@media only screen and (max-width:580px){
	.nav-btn div > span{
    height: 0.5vh;
      width: 70%;
      background-color: #008753;
      display: block;
      border-radius: 1px;

      margin: auto;
      margin-bottom: 5px;
      margin-top: 10px;
	}
}

 </style>
 <script src="https://kit.fontawesome.com/ae1566a18b.js" crossorigin="anonymous"></script>

   <title>FSD | Dashboard</title>
 </head>
  <body onload="">
    <!-- <header>
    		<div class="logo">  <a href="/"><img src="/static/accounts/images/logo3.png" alt=""></a></div>
    	</header> -->
    	<div class="nav-btn">
<div class="">
  <span style="transform: matrix(1, 0, 0, 1, 0, 0);"></span>
    <span style="transform: matrix(1, 0, 0, 1, 0, 0);"></span>
    <span style="transform: matrix(1, 0, 0, 1, 0, 0);"></span>
</div>
    </div>
    	<div class="container ">

    		<div class="sidebar">
    			<nav>
            <a class ="hidelogo" style="padding-bottom: 15px;" href="/"><img src="/static/accounts/images/logo3.png" alt=""></a>
            <p style="color:#fff; text-align:center;margin-bottom:2px;">Hello, {{user.first_name}} </p>
    			<div class="tab">
            <ul>
              <li class="tablinks"><i class="fa fa-fw fa-user"></i><a href="#profile">Profile</a></li>
              <li class="tablinks"><i class="fa fa-fw fa-key"></i><a href="#changepassword" >Change Password</a></li>
              <li class="tablinks transactions"><i class="fa fa-fw fa-receipt"></i><a  href="#transactions">Transactions</a></li>
              <li class="tablinks"><i class="fa fa-fw fa-money-bill-wave-alt"></i><a  href="#makepayment">Make Payment</a></li>
              <li class="tablinks active"><i class="fa fa-fw fa-user-friends"></i><a  href="#invite">Invite Friends</a></li>
              <li class="tablinks"><i class="fa fa-fw fa-user-friends"></i><a  href="signout">Log Out</a></li>
            </ul>
          </div>
    			</nav>
    		</div>
     <div class="tab-content2">
       <div class="tab-pane2" id="profile">
    		<div class="main-content">
    			<h1>Dashboard</h1>
    			<p>Here you can stuff!</p>
    			<div class="panel-wrapper">
    				<div class="panel-head">
    					News
    				</div>
    				<div class="panel-body">
    					Lorem ipsum dolor sit amet, consectetur adipisicing elit. Totam fugiat culpa quia possimus molestiae id sapiente ad eveniet, aliquid, eum sint fuga eius, ratione suscipit ut minus voluptates dicta nesciunt.
    				</div>
    			</div>
    			<div class="panel-wrapper">
    				<div class="panel-head">
    					News
    				</div>
    				<div class="panel-body">
    					Lorem ipsum dolor sit amet, consectetur adipisicing elit. Totam fugiat culpa quia possimus molestiae id sapiente ad eveniet, aliquid, eum sint fuga eius, ratione suscipit ut minus voluptates dicta nesciunt.
    				</div>
    			</div>
    			<div class="panel-wrapper">
    				<div class="panel-head">
    					News
    				</div>
    				<div class="panel-body">
    					Lorem ipsum dolor sit amet, consectetur adipisicing elit. Totam fugiat culpa quia possimus molestiae id sapiente ad eveniet, aliquid, eum sint fuga eius, ratione suscipit ut minus voluptates dicta nesciunt. Totam fugiat culpa quia possimus molestiae id sapiente ad eveniet, aliquid, eum sint fuga eius, ratione suscipit ut minus voluptates dicta nesciunt.
    				</div>
    			</div>
    		</div>
    	</div>
    <div class="tab-pane2" id="changepassword">
      <div class="main-content">
      <form class="row register-form" method="post">
            {% csrf_token %}
                        <div class="col-md-6">
                          <div class="form-group">
                              {{cpwordform}}
                          </div>

                        <div class="form-group">
                          <button type="submit" >Submit</button>
                        </div>
                        </div>
              </form>
    </div>
  </div>
    <div class="tab-pane2" id="transactions" >
        <div class="main-content" >
          <p style="color:#008753" id="paymessage"></p>
          <div class="row">
            <div class="" style="width: 100%; margin-bottom: 3%;" >
              <form class="membersearch">
                          <div class="input-group" style="width: 30%;border: none;">
                            <input type="text"  placeholder="Search for...">
                            <span class="input-group-append">
                              <button class="" type="button">
                                <i class="fa fa-fw fa-search"></i>
                              </button>
                            </span>
                          </div>

                        <div class="col30" style="width: 30%;float: right; margin-left: auto;  border: none;">
                          <label for="id_action" style="padding-right: 3%;margin: auto;">Filter By</label>
                          <select name="action" class="form-control" required="" id="id_action" style="width:70%; font-size:14px">
                          <option value="" selected="">--Select--</option>
                          <option value="Send SMS">State Of Origin</option>
                          <option value="Send Email">State Of Residence</option>
                          <option value="Send Email">Country Of Residence</option>
                          <option value="Gender">Gender</option>
                        </select>

                        </div>
              </form>
            </div>

          </div>
          <div class="rowfull">
            <div class="card-header">
               Transactions List
            </div>
            <div class="card-body" style="overflow-x:auto; padding:0">
              <table id="myTable2" style="width:100%;margin:auto;overflow:scroll">
                <thead>
                  <th>
                    <input type="checkbox" name="" value="">
                  </th><th onclick="sortTable(0)">S/N</th><th onclick="sortTable(1)">Transaction Type</th><th onclick="sortTable(2)">Transaction Reference</th><th onclick="sortTable(3)">Payment Date</th><th onclick="sortTable(4)">Amount</th><th>Paymemnt Channel</th><th>Transaction Status</th>
                </thead>
                <tbody>
                   {% for transaction in transactionlist %}
                    <tr><td><input type="checkbox" id="user_selection" name="" value=""></td>
                      <td>{{forloop.counter}}</td><td>{{transaction.payment_type}}</td><td>{{transaction.transaction_reference}}</td><td>{{transaction.date_of_transaction}}</td><td>{{transaction.amount}}</td><td>{{transaction.payment_channel}}</td><td>{{transaction.status}}</td>
                    </tr>
                   {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    <div class="tab-pane2" id="makepayment">
      <div class="main-content">
        <form class="row register-form" data-verify-transaction-url ="{% url 'accounts:verify_transaction' %}" id="paymentForm" method="post">
              {% csrf_token %}
                          <div class="col-md-6">
                            <div class="form-group">
                                {{payform.transtype.errors}}
                                <label for="{{ payform.transtype.id_for_label }}">Payment Type</label>
                                {{payform.transtype}}
                            </div>
                              <div class="form-group">
                                  {{payform.first_name.errors}}
                                  <label for="{{ payform.first_name.id_for_label }}">First Name</label>
                                  {{payform.first_name}}
                              </div>
                              <div class="form-group">
                                {{payform.middle_name.errors}}
                                <label for="{{ payform.middle_name.id_for_label }}">Middle Name</label>
                                {{payform.middle_name}}
                              </div>
                              <div class="form-group">
                                {{payform.last_name.errors}}
                                <label for="{{ payform.last_name.id_for_label }}">Last Name</label>
                                {{payform.last_name}}
                              </div>
                              <div class="form-group">
                                {{paystackform.email.errors}}
                                <label for="{{ payform.email.id_for_label }}">Email</label>
                                {{payform.email}}
                            </div>
                            <div class="form-group">
                              {{paystackform.amount.errors}}
                              <label for="{{ payform.email.id_for_label }}">Amount</label>
                              {{payform.amount}}
                          </div>
                          <div class="form-submit">
                            <button type="button" id="button"> Pay </button>
                          </div>
                          </div>
                </form>
      </div></div>
    <div class="tab-pane2" id="invite">
      <div class="main-content">
        <p style="color:#008753">{% if message %}<strong>{{ message }}</strong>{% endif %}</p>
        <div class="col-md-12 register-right">
        <a id="hidelogo" href="/"><img  src="/static/fds_app/images/logo2.png" alt=""></a>
            <h3>Invite your friends!</h3>
            <p>Make sure to use your referral link when you share with your friends. Let them strat contributing positive change in the economic and social status of African youth through effective programs that delivers sustainable outcome.</p>
            <div class="input-group mb-3">
              <input type="text" id="referrallink" name="referrallink" value="https://fsdinvite.com/d/EJnV9JNip7-ocDH33Mo" readonly="">
              <div class="input-group-append">
                 <button class="btn btn-danger" type="button" onclick="copyText()">Copy</button>
           </div>
         </div>
         <h3>Invite by Email</h3>
         <p>Enter details of your friends as many times as you would like to see join us</p>

            <form class="row register-form" method="post">
                {% csrf_token %}

                <div class="col-md-4">
                    <div class="form-group">
                        {{form.first_name_1.errors}}
                        <label for="{{ form.first_name_1.id_for_label }}">First Name</label>
                        {{form.first_name_1}}
                    </div>
              </div>
              <div class="col-md-4">
                  <div class="form-group">
                      {{form.last_name_1.errors}}
                      <label for="{{ form.last_name_1.id_for_label }}">Last Name</label>
                      {{form.last_name_1}}
                  </div>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    {{form.email_1.errors}}
                    <label for="{{ form.email_1.id_for_label }}">Email</label>
                    {{form.email_1}}
                </div>
          </div>
              {{form.ref_email}}
              <input type="submit" class="btn btn-info" value="Invite">
            </form>
          </div>
</div>
</div>
</div>


<script src="https://js.paystack.co/v1/inline.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.23.0/moment.min.js" integrity="sha256-VBLiveTKyUZMEzJd6z2mhfxIqz3ZATCuVMawPZGzIfA=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.1.2/js/tempusdominus-bootstrap-4.min.js" integrity="sha256-z0oKYg6xiLq3yJGsp/LsY9XykbweQlHl42jHv2XTBz4=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
<script>
  $(document).ready(function() {
    $("#profile").show();
  	$('.nav-btn').on('click', function(event) {
  		event.preventDefault();
  		/* Act on the event */
  		$('.sidebar').slideToggle('fast');

  		window.onresize = function(){
  			if ($(window).width() >= 768) {
  				$('.sidebar').show();
  			} else {
  				$('.sidebar').hide();
  			}
  		};
  	});
  });
</script>
<script >
$(document).ready(function(){
  $(".tablinks").each(function(index) {
    var divKey = $(this).find('a').attr('href');
    $(divKey).hide() })
 var at = $(".tablinks.active > a")
 at.click()
});
</script>
<script>
  $(".tablinks").each(function(index) {
    $(this).on("click", function(){
        var divKey = $(this).find('a').attr('href');
        $(divKey).show() ;
        $('.tab-pane2').not(divKey).hide();
        $(this).addClass("active");
        $('.tablinks').not(this).removeClass("active");

    });
});
</script>
<script>
$(document).ready(function() {
});
$('#button').on("click",function(e){
var paymentForm = document.getElementById('paymentForm');
//payWithPaystack()
//paymentForm.addEventListener('submit', payWithPaystack, false);
//function payWithPaystack() {
e.preventDefault()
  var handler = PaystackPop.setup({
    key: 'pk_test_9a8813ed57ce1f4a2c86176d714fb076f0a551c1', // Replace with your public key
    email: document.getElementById("id_email").value,
    amount: document.getElementById("id_amount").value * 100,
    currency: 'NGN', // Use GHS for Ghana Cedis or USD for US Dollars
    //ref: ''+Math.floor((Math.random() * 1000000000) + 1), // generates a pseudo-unique reference. Please replace with a reference you generated. Or remove the line entirely so our API will generate one for you
    // label: "Optional string that replaces customer email"
    onClose: function(){
      alert('Transaction was not completed, window closed.');
    },

    callback: function(response){
      var ref = response.reference
      let message = 'Payment complete! Reference: ' + response.reference;
      alert(message);
      $.ajax({
        type: 'POST',
        url: 'verify_transaction',
        data: {
          'reference': ref,
          'email': document.getElementById("id_email").value,
          'first_name': document.getElementById("id_first_name").value,
          'last_name': document.getElementById("id_last_name").value,
          'middle_name': document.getElementById("id_middle_name").value,
          'amount':document.getElementById("id_amount").value,
          'transtype':document.getElementById("id_transtype").value,
          'csrfmiddlewaretoken': $('input[name="csrfmiddlewaretoken"]').prop('value'),
        },
        dataType: 'json',
        success: function(data) {
          if (data.status_message){
           $("#paymessage").html(data.status_message)
          }
          if (data.transactionlist){
             transactionlist = data.transactionlist
             for (var i = 0; i < array.length; i++) {
                $('#myTable2 tbody').append('<tr>')
                .append('<td>').html(transactionlist[0][0])
                .append('<td>').html(transactionlist[0][1])
             }
          }
        $('.tablinks.transactions > a').click();
        }
      });
   }

  });

  handler.openIframe();
});

</script>

</body>
</html>
